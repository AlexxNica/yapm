// vim: set softtabstop=16 shiftwidth=16:
var tap = require("tap")
var readJson = require("../")
var path = require("path")
var fs = require("fs")

console.error("BOM test")
tap.test("BOM test", function (t) {
                var p = path.resolve(__dirname, "fixtures/bom.json")
                readJson(p, function (er, data, raw) {
                                if (er) throw er;
                                p = path.resolve(__dirname, "fixtures/nobom.json")
                                // okay, we don't preserve boms; patch welcome
                                //t.equal(fs.readFileSync(p, 'utf8'), raw)
                                readJson(p, function (er, data2, raw) {
                                                if (er) throw er;
                                                t.equal(fs.readFileSync(p, 'utf8'), raw)
                                                t.deepEqual(data, data2)
                                                t.end()
                                })
                })
})
